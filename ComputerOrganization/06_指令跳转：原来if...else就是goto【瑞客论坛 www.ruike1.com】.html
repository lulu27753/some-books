<html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover"> <meta name="format-detection" content="telephone=no"> <title>06 | 指令跳转：原来if...else就是goto</title>         <style type="text/css"> html { color: #333; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; text-rendering: optimizelegibility; font-family: Helvetica Neue,PingFang SC,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif } html.borderbox *,html.borderbox :after,html.borderbox :before { box-sizing: border-box } article,aside,blockquote,body,button,code,dd,details,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hr,input,legend,li,menu,nav,ol,p,pre,section,td,textarea,th,ul { margin: 0; padding: 0 } article,aside,details,figcaption,figure,footer,header,menu,nav,section { display: block } audio,canvas,video { display: inline-block } body,button,input,select,textarea { font: 300 1em/1.8 PingFang SC,Lantinghei SC,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,Helvetica,sans-serif } button::-moz-focus-inner,input::-moz-focus-inner { padding: 0; border: 0 } table { border-collapse: collapse; border-spacing: 0 } fieldset,img { border: 0 } blockquote { position: relative; color: #999; font-weight: 400; border-left: 1px solid #1abc9c; padding-left: 1em; margin: 1em 3em 1em 2em } @media only screen and (max-width: 640px) { blockquote { margin:1em 0 } } abbr,acronym { border-bottom: 1px dotted; font-variant: normal } abbr { cursor: help } del { text-decoration: line-through } address,caption,cite,code,dfn,em,th,var { font-style: normal; font-weight: 400 } ol,ul { list-style: none } caption,th { text-align: left } q:after,q:before { content: "" } sub,sup { font-size: 75%; line-height: 0; position: relative } :root sub,:root sup { vertical-align: baseline } sup { top: -.5em } sub { bottom: -.25em } a { color: #1abc9c } a:hover { text-decoration: underline } .typo a { border-bottom: 1px solid #1abc9c } .typo a:hover { border-bottom-color: #555; color: #555 } .typo a:hover,a,ins { text-decoration: none } .typo-u,u { text-decoration: underline } mark { background: #fffdd1; border-bottom: 1px solid #ffedce; padding: 2px; margin: 0 5px } code,pre,pre tt { font-family: Courier,Courier New,monospace } pre { background: hsla(0,0%,97%,.7); border: 1px solid #ddd; padding: 1em 1.5em; display: block; -webkit-overflow-scrolling: touch } hr { border: none; border-bottom: 1px solid #cfcfcf; margin-bottom: .8em; height: 10px } .typo-small,figcaption,small { font-size: .9em; color: #888 } b,strong { font-weight: 700; color: #000 } [draggable] { cursor: move } .clearfix:after,.clearfix:before { content: ""; display: table } .clearfix:after { clear: both } .clearfix { zoom:1} .textwrap,.textwrap td,.textwrap th { word-wrap: break-word; word-break: break-all } .textwrap-table { table-layout: fixed } .serif { font-family: Palatino,Optima,Georgia,serif } .typo-dl,.typo-form,.typo-hr,.typo-ol,.typo-p,.typo-pre,.typo-table,.typo-ul,.typo dl,.typo form,.typo hr,.typo ol,.typo p,.typo pre,.typo table,.typo ul,blockquote { margin-bottom: 1rem } h1,h2,h3,h4,h5,h6 { font-family: PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif; color: #000; line-height: 1.35 } .typo-h1,.typo-h2,.typo-h3,.typo-h4,.typo-h5,.typo-h6,.typo h1,.typo h2,.typo h3,.typo h4,.typo h5,.typo h6 { margin-top: 1.2em; margin-bottom: .6em; line-height: 1.35 } .typo-h1,.typo h1 { font-size: 2em } .typo-h2,.typo h2 { font-size: 1.8em } .typo-h3,.typo h3 { font-size: 1.6em } .typo-h4,.typo h4 { font-size: 1.4em } .typo-h5,.typo-h6,.typo h5,.typo h6 { font-size: 1.2em } .typo-ul,.typo ul { margin-left: 1.3em; list-style: disc } .typo-ol,.typo ol { list-style: decimal; margin-left: 1.9em } .typo-ol ol,.typo-ol ul,.typo-ul ol,.typo-ul ul,.typo li ol,.typo li ul { margin-bottom: .8em; margin-left: 2em } .typo-ol ul,.typo-ul ul,.typo li ul { list-style: circle } .typo-table td,.typo-table th,.typo table caption,.typo table td,.typo table th { border: 1px solid #ddd; padding: .5em 1em; color: #666 } .typo-table th,.typo table th { background: #fbfbfb } .typo-table thead th,.typo table thead th { background: hsla(0,0%,95%,.7) } .typo table caption { border-bottom: none } .typo-input,.typo-textarea { -webkit-appearance: none; border-radius: 0 } .typo-em,.typo em,caption,legend { color: #000; font-weight: inherit } .typo-em { position: relative } .typo-em:after { position: absolute; top: .65em; left: 0; width: 100%; overflow: hidden; white-space: nowrap; content: "\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB" } .typo img { max-width: 100% } .common-content { font-weight: 400; color: #353535; line-height: 1.75rem; white-space: normal; word-break: normal; font-size: 1rem } .common-content img { display: block; max-width: 100%; background-color: #eee } .common-content audio,.common-content video { width: 100%; background-color: #eee } .common-content center,.common-content font { margin-top: 1rem; display: inline-block } .common-content center { width: 100% } .common-content pre { margin-top: 1rem; padding-left: 0; padding-right: 0; position: relative; overflow: hidden } .common-content pre code { font-size: .8rem; font-family: Consolas,Liberation Mono,Menlo,monospace,Courier; display: block; width: 100%; box-sizing: border-box; padding-left: 1rem; padding-right: 1rem; overflow-x: auto } .common-content hr { border: none; margin-top: 1.5rem; margin-bottom: 1.5rem; border-top: 1px solid #f5f5f5; height: 1px; background: none } .common-content b,.common-content h1,.common-content h2,.common-content h3,.common-content h4,.common-content h5,.common-content strong { font-weight: 700 } .common-content h1,.common-content h2 { font-size: 1.125rem; margin-bottom: .45rem } .common-content h3,.common-content h4,.common-content h5 { font-size: 1rem; margin-bottom: .45rem } .common-content p { font-weight: 400; color: #353535; margin-top: .15rem } .common-content .orange { color: #ff5a05 } .common-content .reference { font-size: 1rem; color: #888 } .custom-rich-content h1 { margin-top: 0; font-weight: 400; font-size: 15.25px; border-bottom: 1px solid #eee; line-height: 2.8 } .custom-rich-content li,.custom-rich-content p { font-size: 14px; color: #888; line-height: 1.6 } table.hljs-ln { margin-bottom: 0; border-spacing: 0; border-collapse: collapse } table.hljs-ln,table.hljs-ln tbody,table.hljs-ln td,table.hljs-ln tr { box-sizing: border-box } table.hljs-ln td { padding: 0; border: 0 } table.hljs-ln td.hljs-ln-numbers { min-width: 15px; color: rgba(27,31,35,.3); text-align: right; white-space: nowrap; cursor: pointer; user-select: none } table.hljs-ln td.hljs-ln-code,table.hljs-ln td.hljs-ln-numbers { font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace; font-size: 12px; line-height: 20px; vertical-align: top } table.hljs-ln td.hljs-ln-code { position: relative; padding-right: 10px; padding-left: 10px; overflow: visible; color: #24292e; word-wrap: normal; white-space: pre } video::-webkit-media-controls { overflow: hidden!important } video::-webkit-media-controls-enclosure { width: calc(100% + 32px); margin-left: auto } .button-cancel { color: #888; border: 1px solid #888; border-radius: 3px; margin-right: 12px } .button-cancel,.button-primary { -ms-flex-positive: 1; flex-grow: 1; height: 35px; display: inline-block; font-size: 15px; text-align: center; line-height: 36px } .button-primary { color: #fff; background-color: #ff5a05; border-radius: 3px } @font-face { font-family: iconfont; src: url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot); src: url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.woff) format("woff"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.ttf) format("truetype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.svg#iconfont) format("svg") } @font-face { font-family: player-font; src: url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot); src: url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.woff) format("woff"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.ttf) format("truetype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.svg#player-font) format("svg") } .iconfont { font-family: iconfont!important; font-size: 16px; font-style: normal; -webkit-font-smoothing: antialiased; -webkit-text-stroke-width: .2px; -moz-osx-font-smoothing: grayscale } html { background: #fff; min-height: 100%; -webkit-tap-highlight-color: rgba(0,0,0,0) } body { width: 100% } body.fixed { overflow: hidden; position: fixed; width: 100vw; height: 100vh } i { font-style: normal } a { word-wrap: break-word; -webkit-tap-highlight-color: rgba(0,0,0,0) } a:hover { text-decoration: none } .fade-enter-active,.fade-leave-active { transition: opacity .3s } .fade-enter,.fade-leave-to { opacity: 0 } .MathJax,.MathJax_CHTML,.MathJax_MathContainer,.MathJax_MathML,.MathJax_PHTML,.MathJax_PlainSource,.MathJax_SVG { outline: 0 } .ios-app-switch .js-audit { display: none } ._loading_wrap_ { position: fixed; width: 100vw; height: 100vh; top: 50%; left: 50%; transform: translate(-50%,-50%); z-index: 999 } ._loading_div_class_,._loading_wrap_ { display: -ms-flexbox; display: flex; -ms-flex-pack: center; justify-content: center; -ms-flex-align: center; align-items: center } ._loading_div_class_ { word-wrap: break-word; padding: .5rem .75rem; text-align: center; z-index: 9999; font-size: .6rem; max-width: 60%; color: #fff; border-radius: .25rem; -ms-flex-direction: column; flex-direction: column } ._loading_div_class_ .message { color: #353535; font-size: 16px; line-height: 3 } .spinner { animation: circle-rotator 1.4s linear infinite } .spinner * { line-height: 0; box-sizing: border-box } @keyframes circle-rotator { 0% { transform: rotate(0deg) } to { transform: rotate(270deg) } } .path { stroke-dasharray: 187; stroke-dashoffset: 0; transform-origin: center; animation: circle-dash 1.4s ease-in-out infinite,circle-colors 5.6s ease-in-out infinite } @keyframes circle-colors { 0% { stroke: #ff5a05 } to { stroke: #ff5a05 } } @keyframes circle-dash { 0% { stroke-dashoffset: 187 } 50% { stroke-dashoffset: 46.75; transform: rotate(135deg) } to { stroke-dashoffset: 187; transform: rotate(450deg) } } .confirm-box-wrapper,.confirm-box-wrapper .mask { position: absolute; top: 0; left: 0; right: 0; bottom: 0 } .confirm-box-wrapper .mask { background: rgba(0,0,0,.6) } .confirm-box-wrapper .confirm-box { position: fixed; top: 50%; left: 50%; width: 267px; background: #fff; transform: translate(-50%,-50%); border-radius: 7px } .confirm-box-wrapper .confirm-box .head { margin: 0 18px; font-size: 18px; text-align: center; line-height: 65px; border-bottom: 1px solid #d9d9d9 } .confirm-box-wrapper .confirm-box .body { padding: 18px; padding-bottom: 0; color: #353535; font-size: 12.5px; max-height: 150px; overflow: auto } .confirm-box-wrapper .confirm-box .foot { display: -ms-flexbox; display: flex; -ms-flex-direction: row; flex-direction: row; padding: 18px } .confirm-box-wrapper .confirm-box .foot .button-cancel { border: 1px solid #d9d9d9 } .hljs { display: block; overflow-x: auto; padding: .5em; color: #333; background: #f8f8f8 } .hljs-comment,.hljs-quote { color: #998; font-style: italic } .hljs-keyword,.hljs-selector-tag,.hljs-subst { color: #333; font-weight: 700 } .hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable { color: teal } .hljs-doctag,.hljs-string { color: #d14 } .hljs-section,.hljs-selector-id,.hljs-title { color: #900; font-weight: 700 } .hljs-subst { font-weight: 400 } .hljs-class .hljs-title,.hljs-type { color: #458; font-weight: 700 } .hljs-attribute,.hljs-name,.hljs-tag { color: navy; font-weight: 400 } .hljs-link,.hljs-regexp { color: #009926 } .hljs-bullet,.hljs-symbol { color: #990073 } .hljs-built_in,.hljs-builtin-name { color: #0086b3 } .hljs-meta { color: #999; font-weight: 700 } .hljs-deletion { background: #fdd } .hljs-addition { background: #dfd } .hljs-emphasis { font-style: italic } .hljs-strong { font-weight: 700 } .button-cancel[data-v-87ffcada] { color: #888; border: 1px solid #888; border-radius: 3px; margin-right: 12px } .button-cancel[data-v-87ffcada],.button-primary[data-v-87ffcada] { -webkit-box-flex: 1; -ms-flex-positive: 1; flex-grow: 1; height: 35px; display: inline-block; font-size: 15px; text-align: center; line-height: 36px } .button-primary[data-v-87ffcada] { color: #fff; background-color: #ff5a05; border-radius: 3px } .pd[data-v-87ffcada] { padding-left: 1.375rem; padding-right: 1.375rem } .article[data-v-87ffcada] { max-width: 70rem; margin: 0 auto } .article .article-unavailable[data-v-87ffcada] { color: #fa8919; font-size: 15px; font-weight: 600; line-height: 24px; border-radius: 5px; padding: 12px; background-color: #f6f7fb; margin-top: 20px } .article .article-unavailable .iconfont[data-v-87ffcada] { font-size: 12px } .article .main[data-v-87ffcada] { padding: 1.25rem 0; margin-bottom: 52px } .article-title[data-v-87ffcada] { color: #353535; font-weight: bold; line-height: 1.65rem; font-size: 1.34375rem } .article-info[data-v-87ffcada] { color: #888; font-size: .9375rem; margin-top: 1.0625rem } .article-content[data-v-87ffcada] { margin-top: 1.0625rem } .article-content.android video[data-v-87ffcada]::-webkit-media-controls-fullscreen-button { display: none } .copyright[data-v-87ffcada] { color: #b2b2b2; padding-bottom: 20px; margin-top: 20px; font-size: 13px } .audio-player[data-v-87ffcada] { width: 100%; margin: 20px 0 } .to-comment[data-v-87ffcada] { overflow: hidden; padding-top: 10px; margin-bottom: -30px } .to-comment a.button-primary[data-v-87ffcada] { float: right; height: 20px; font-size: 12px; line-height: 20px; padding: 4px 8px; cursor: pointer } .article-comments[data-v-87ffcada] { margin-top: 2rem } .article-comments h2[data-v-87ffcada] { text-align: center; color: #888; position: relative; z-index: 1; margin-bottom: 1rem } .article-comments h2[data-v-87ffcada]:before { border-top: 1px dotted #888; content: ""; position: absolute; top: 56%; left: 0; width: 100%; z-index: -1 } .article-comments h2 span[data-v-87ffcada] { font-size: 15.25px; font-weight: 400; padding: 0 1rem; background: #fff; display: inline-block } .article-sub-bottom[data-v-87ffcada] { z-index: 10; cursor: pointer } .switch-btns[data-v-87ffcada] { height: 76px; cursor: pointer; padding-top: 24px; padding-bottom: 24px; border-bottom: 10px solid #f6f7fb; position: relative } .switch-btns[data-v-87ffcada]:before { content: " "; height: 1px; background: #e8e8e8; position: absolute; top: 0; left: 0; -webkit-box-sizing: border-box; box-sizing: border-box; left: 1.375rem; right: 1.375rem } .switch-btns .btn[data-v-87ffcada] { height: 38px; display: -webkit-box; display: -ms-flexbox; display: flex; -webkit-box-align: center; -ms-flex-align: center; align-items: center } .switch-btns .btn .tag[data-v-87ffcada] { -webkit-box-flex: 0; -ms-flex: 0 0 62px; flex: 0 0 62px; text-align: center; color: #888; font-size: 14px; border-radius: 10px; height: 22px; line-height: 22px; background: #f6f7fb; font-weight: 400 } .switch-btns .btn .txt[data-v-87ffcada] { margin-left: 10px; -webkit-box-flex: 1; -ms-flex: 1 1 auto; flex: 1 1 auto; color: #888; font-size: 15px; height: 22px; line-height: 22px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-weight: 400 } @media (max-width: 769px) { .article .breadcrumb[data-v-87ffcada] { padding-top:10px; padding-bottom: 10px } } .comment-item { list-style-position: inside; width: 100%; display: -webkit-box; display: -ms-flexbox; display: flex; -webkit-box-orient: horizontal; -webkit-box-direction: normal; -ms-flex-direction: row; flex-direction: row; margin-bottom: 1rem } .comment-item a { border-bottom: none } .comment-item .avatar { width: 2.625rem; height: 2.625rem; -ms-flex-negative: 0; flex-shrink: 0; border-radius: 50% } .comment-item .info { margin-left: .5rem; -webkit-box-flex: 1; -ms-flex-positive: 1; flex-grow: 1 } .comment-item .info .hd { width: 100%; display: -webkit-box; display: -ms-flexbox; display: flex; -webkit-box-orient: horizontal; -webkit-box-direction: normal; -ms-flex-direction: row; flex-direction: row; -webkit-box-pack: justify; -ms-flex-pack: justify; justify-content: space-between; -webkit-box-align: center; -ms-flex-align: center; align-items: center } .comment-item .info .hd .username { color: #888; font-size: 15.25px; font-weight: 400; line-height: 1.2 } .comment-item .info .hd .control { display: -webkit-box; display: -ms-flexbox; display: flex; -webkit-box-orient: horizontal; -webkit-box-direction: normal; -ms-flex-direction: row; flex-direction: row; -webkit-box-align: center; -ms-flex-align: center; align-items: center } .comment-item .info .hd .control .btn-share { color: #888; font-size: .75rem; margin-right: 1rem } .comment-item .info .hd .control .btn-praise { display: -webkit-box; display: -ms-flexbox; display: flex; -webkit-box-orient: horizontal; -webkit-box-direction: normal; -ms-flex-direction: row; flex-direction: row; -webkit-box-align: center; -ms-flex-align: center; align-items: center; font-size: 15.25px; text-decoration: none } .comment-item .info .hd .control .btn-praise i { color: #888; display: inline-block; font-size: .75rem; margin-right: .3rem; margin-top: -.01rem } .comment-item .info .hd .control .btn-praise i.on,.comment-item .info .hd .control .btn-praise span { color: #ff5a05 } .comment-item .info .bd { color: #353535; font-size: 15.25px; font-weight: 400; white-space: normal; word-break: break-all; line-height: 1.6 } .comment-item .info .time { color: #888; font-size: 9px; line-height: 1 } .comment-item .info .reply .reply-hd { font-size: 15.25px } .comment-item .info .reply .reply-hd span { margin-left: -12px; color: #888; font-weight: 400 } .comment-item .info .reply .reply-hd i { color: #ff5a05; font-size: 15.25px } .comment-item .info .reply .reply-content { background: #f6f7fb; padding: 18px; border-radius: 10px; color: #353535; font-size: 15.25px; font-weight: 400; white-space: normal; word-break: break-all } .comment-item .info .reply .reply-time { color: #888; font-size: 9px } </style> </head> <body> <div id="app"> <div data-v-87ffcada="" class="article" id="watermark"> <div data-v-87ffcada="" class="main main-app"> <h1 data-v-87ffcada="" class="article-title pd"> 06 | 指令跳转：原来if...else就是goto </h1> <hr> <div data-v-87ffcada="" class="article-content typo common-content pd"> <img data-v-87ffcada="" src="https://static001.geekbang.org/resource/image/a4/2c/a44acf3e8c9940d9bc8f0c3ef39cf62c.jpg"> <div data-v-87ffcada="" id="article-content" class=""> <div class="text"> <p>上一讲，我们讲解了一行代码是怎么变成计算机指令的。你平时写的程序中，肯定不只有int a = 1这样最最简单的代码或者指令。我们总是要用到if…else这样的条件判断语句、while和for这样的循环语句，还有函数或者过程调用。</p><p>对应的，CPU执行的也不只是一条指令，一般一个程序包含很多条指令。因为有if…else、for这样的条件和循环存在，这些指令也不会一路平铺直叙地执行下去。</p><p>今天我们就在上一节的基础上来看看，一个计算机程序是怎么被分解成一条条指令来执行的。</p><h2>CPU是如何执行指令的？</h2><p>拿我们用的Intel CPU来说，里面差不多有几百亿个晶体管。实际上，一条条计算机指令执行起来非常复杂。好在CPU在软件层面已经为我们做好了封装。对于我们这些做软件的程序员来说，我们只要知道，写好的代码变成了指令之后，是一条一条<strong>顺序</strong>执行的就可以了。</p><p>我们先不管几百亿的晶体管的背后是怎么通过电路运转起来的，逻辑上，我们可以认为，CPU其实就是由一堆寄存器组成的。而寄存器就是CPU内部，由多个触发器（Flip-Flop）或者锁存器（Latches）组成的简单电路。</p><p>触发器和锁存器，其实就是两种不同原理的数字电路组成的逻辑门。这块内容并不是我们这节课的重点，所以你只要了解就好。如果想要深入学习的话，你可以学习数字电路的相关课程，这里我们不深入探讨。</p><!-- [[[read_end]]] --><p>好了，现在我们接着前面说。N个触发器或者锁存器，就可以组成一个N位（Bit）的寄存器，能够保存N位的数据。比方说，我们用的64位Intel服务器，寄存器就是64位的。</p><p><img src="https://static001.geekbang.org/resource/image/cd/6f/cdba5c17a04f0dd5ef05b70368b9a96f.jpg" alt=""></p><p>一个CPU里面会有很多种不同功能的寄存器。我这里给你介绍三种比较特殊的。</p><p>一个是<strong>PC寄存器</strong>（Program Counter Register），我们也叫<strong>指令地址寄存器</strong>（Instruction Address Register）。顾名思义，它就是用来存放下一条需要执行的计算机指令的内存地址。</p><p>第二个是<strong>指令寄存器</strong>（Instruction Register），用来存放当前正在执行的指令。</p><p>第三个是<strong>条件码寄存器</strong>（Status Register），用里面的一个一个标记位（Flag），存放CPU进行算术或者逻辑计算的结果。</p><p>除了这些特殊的寄存器，CPU里面还有更多用来存储数据和内存地址的寄存器。这样的寄存器通常一类里面不止一个。我们通常根据存放的数据内容来给它们取名字，比如整数寄存器、浮点数寄存器、向量寄存器和地址寄存器等等。有些寄存器既可以存放数据，又能存放地址，我们就叫它通用寄存器。</p><p><img src="https://static001.geekbang.org/resource/image/ad/8a/ad91b005e97959d571bbd2a0fa30b48a.jpeg" alt=""></p><p>实际上，一个程序执行的时候，CPU会根据PC寄存器里的地址，从内存里面把需要执行的指令读取到指令寄存器里面执行，然后根据指令长度自增，开始顺序读取下一条指令。可以看到，一个程序的一条条指令，在内存里面是连续保存的，也会一条条顺序加载。</p><p>而有些特殊指令，比如上一讲我们讲到J类指令，也就是跳转指令，会修改PC寄存器里面的地址值。这样，下一条要执行的指令就不是从内存里面顺序加载的了。事实上，这些跳转指令的存在，也是我们可以在写程序的时候，使用if…else条件语句和while/for循环语句的原因。</p><h2>从if…else来看程序的执行和跳转</h2><p>我们现在就来看一个包含if…else的简单程序。</p><pre><code>// test.c


#include &lt;time.h&gt;
#include &lt;stdlib.h&gt;


int main()
{
  srand(time(NULL));
  int r = rand() % 2;
  int a = 10;
  if (r == 0)
  {
    a = 1;
  } else {
    a = 2;
  } 
</code></pre><p>我们用rand生成了一个随机数r，r要么是0，要么是1。当r是0的时候，我们把之前定义的变量a设成1，不然就设成2。</p><pre><code>$ gcc -g -c test.c
$ objdump -d -M intel -S test.o 
</code></pre><p>我们把这个程序编译成汇编代码。你可以忽略前后无关的代码，只关注于这里的if…else条件判断语句。对应的汇编代码是这样的：</p><pre><code>    if (r == 0)
  3b:   83 7d fc 00             cmp    DWORD PTR [rbp-0x4],0x0
  3f:   75 09                   jne    4a &lt;main+0x4a&gt;
    {
        a = 1;
  41:   c7 45 f8 01 00 00 00    mov    DWORD PTR [rbp-0x8],0x1
  48:   eb 07                   jmp    51 &lt;main+0x51&gt;
    }
    else
    {
        a = 2;
  4a:   c7 45 f8 02 00 00 00    mov    DWORD PTR [rbp-0x8],0x2
  51:   b8 00 00 00 00          mov    eax,0x0
    } 
</code></pre><p>可以看到，这里对于r ==  0的条件判断，被编译成了cmp和jne这两条指令。</p><p>cmp指令比较了前后两个操作数的值，这里的DWORD PTR代表操作的数据类型是32位的整数，而[rbp-0x4]则是一个寄存器的地址。所以，第一个操作数就是从寄存器里拿到的变量r的值。第二个操作数0x0就是我们设定的常量0的16进制表示。cmp指令的比较结果，会存入到<strong>条件码寄存器</strong>当中去。</p><p>在这里，如果比较的结果是 True，也就是 r == 0，就把<strong>零标志条件码</strong>（对应的条件码是ZF，Zero Flag）设置为1。除了零标志之外，Intel的CPU下还有<strong>进位标志</strong>（CF，Carry Flag）、<strong>符号标志</strong>（SF，Sign Flag）以及<strong>溢出标志</strong>（OF，Overflow Flag），用在不同的判断条件下。</p><p>cmp指令执行完成之后，PC寄存器会自动自增，开始执行下一条jne的指令。</p><p>跟着的jne指令，是jump if not equal的意思，它会查看对应的零标志位。如果为0，会跳转到后面跟着的操作数4a的位置。这个4a，对应这里汇编代码的行号，也就是上面设置的else条件里的第一条指令。当跳转发生的时候，PC寄存器就不再是自增变成下一条指令的地址，而是被直接设置成这里的4a这个地址。这个时候，CPU再把4a地址里的指令加载到指令寄存器中来执行。</p><p>跳转到执行地址为4a的指令，实际是一条mov指令，第一个操作数和前面的cmp指令一样，是另一个32位整型的寄存器地址，以及对应的2的16进制值0x2。mov指令把2设置到对应的寄存器里去，相当于一个赋值操作。然后，PC寄存器里的值继续自增，执行下一条mov指令。</p><p>这条mov指令的第一个操作数eax，代表累加寄存器，第二个操作数0x0则是16进制的0的表示。这条指令其实没有实际的作用，它的作用是一个占位符。我们回过头去看前面的if条件，如果满足的话，在赋值的mov指令执行完成之后，有一个jmp的无条件跳转指令。跳转的地址就是这一行的地址51。我们的main函数没有设定返回值，而mov eax, 0x0 其实就是给main函数生成了一个默认的为0的返回值到累加器里面。if条件里面的内容执行完成之后也会跳转到这里，和else里的内容结束之后的位置是一样的。</p><p><img src="https://static001.geekbang.org/resource/image/b4/fa/b439cebb2d85496ad6eef2f61071aefa.jpeg" alt=""></p><p>上一讲我们讲打孔卡的时候说到，读取打孔卡的机器会顺序地一段一段地读取指令，然后执行。执行完一条指令，它会自动地顺序读取下一条指令。如果执行的当前指令带有跳转的地址，比如往后跳10个指令，那么机器会自动将卡片带往后移动10个指令的位置，再来执行指令。同样的，机器也能向前移动，去读取之前已经执行过的指令。这也就是我们的while/for循环实现的原理。</p><h2>如何通过if…else和goto来实现循环？</h2><pre><code>int main()
{
    int a = 0;
    for (int i = 0; i &lt; 3; i++)
    {
        a += i;
    }
}
</code></pre><p>我们再看一段简单的利用for循环的程序。我们循环自增变量i三次，三次之后，i&gt;=3，就会跳出循环。整个程序，对应的Intel汇编代码就是这样的：</p><pre><code>    for (int i = 0; i &lt; 3; i++)
   b:   c7 45 f8 00 00 00 00    mov    DWORD PTR [rbp-0x8],0x0
  12:   eb 0a                   jmp    1e &lt;main+0x1e&gt;
    {
        a += i;
  14:   8b 45 f8                mov    eax,DWORD PTR [rbp-0x8]
  17:   01 45 fc                add    DWORD PTR [rbp-0x4],eax
    for (int i = 0; i &lt; 3; i++)
  1a:   83 45 f8 01             add    DWORD PTR [rbp-0x8],0x1
  1e:   83 7d f8 02             cmp    DWORD PTR [rbp-0x8],0x2
  22:   7e f0                   jle    14 &lt;main+0x14&gt;
  24:   b8 00 00 00 00          mov    eax,0x0
    }
</code></pre><p>可以看到，对应的循环也是用1e这个地址上的cmp比较指令，和紧接着的jle条件跳转指令来实现的。主要的差别在于，这里的jle跳转的地址，在这条指令之前的地址14，而非if…else编译出来的跳转指令之后。往前跳转使得条件满足的时候，PC寄存器会把指令地址设置到之前执行过的指令位置，重新执行之前执行过的指令，直到条件不满足，顺序往下执行jle之后的指令，整个循环才结束。</p><p><img src="https://static001.geekbang.org/resource/image/7c/30/7ca2eaf0df251e2ad16c412f7e625e30.jpeg" alt=""></p><p>如果你看一长条打孔卡的话，就会看到卡片往后移动一段，执行了之后，又反向移动，去重新执行前面的指令。</p><p>其实，你有没有觉得，jle和jmp指令，有点像程序语言里面的goto命令，直接指定了一个特定条件下的跳转位置。虽然我们在用高级语言开发程序的时候反对使用goto，但是实际在机器指令层面，无论是if…else…也好，还是for/while也好，都是用和goto相同的跳转到特定指令位置的方式来实现的。</p><h2>总结延伸</h2><p>这一节，我们在单条指令的基础上，学习了程序里的多条指令，究竟是怎么样一条一条被执行的。除了简单地通过PC寄存器自增的方式顺序执行外，条件码寄存器会记录下当前执行指令的条件判断状态，然后通过跳转指令读取对应的条件码，修改PC寄存器内的下一条指令的地址，最终实现if…else以及for/while这样的程序控制流程。</p><p>你会发现，虽然我们可以用高级语言，可以用不同的语法，比如 if…else 这样的条件分支，或者 while/for 这样的循环方式，来实现不用的程序运行流程，但是回归到计算机可以识别的机器指令级别，其实都只是一个简单的地址跳转而已，也就是一个类似于goto的语句。</p><p>想要在硬件层面实现这个goto语句，除了本身需要用来保存下一条指令地址，以及当前正要执行指令的PC寄存器、指令寄存器外，我们只需要再增加一个条件码寄存器，来保留条件判断的状态。这样简简单单的三个寄存器，就可以实现条件判断和循环重复执行代码的功能。</p><p>下一节，我们会进一步讲解，如果程序中出现函数或者过程这样可以复用的代码模块，对应的指令是怎么样执行的，会和我们这里的if…else有什么不同。</p><h2>推荐阅读</h2><p>《深入理解计算机系统》的第3章，详细讲解了C语言和Intel CPU的汇编语言以及指令的对应关系，以及Intel CPU的各种寄存器和指令集。</p><p>Intel指令集相对于之前的MIPS指令集要复杂一些，一方面，所有的指令是变长的，从1个字节到15个字节不等；另一方面，即使是汇编代码，还有很多针对操作数据的长度不同有不同的后缀。我在这里没有详细解释各个指令的含义，如果你对用C/C++做Linux系统层面开发感兴趣，建议你一定好好读一读这一章节。</p><h2>课后思考</h2><p>除了if…else的条件语句和for/while的循环之外，大部分编程语言还有switch…case这样的条件跳转语句。switch…case编译出来的汇编代码也是这样使用jne指令进行跳转吗？对应的汇编代码的性能和写很多if…else有什么区别呢？你可以试着写一个简单的C语言程序，编译成汇编代码看一看。</p><p>欢迎留言和我分享你的思考和疑惑，你也可以把今天的内容分享给你的朋友，和他一起学习和进步。</p><p><img src="https://static001.geekbang.org/resource/image/28/29/281ca28b90c8aa0aecbb5adc08394f29.jpg" alt=""></p> </div> </div> <div data-v-87ffcada="" class="article-comments"><h2 data-v-87ffcada=""><span data-v-87ffcada="">精选留言</span></h2> <ul data-v-87ffcada="">  <li data-v-87ffcada="" class="comment-item"><img src="" class="avatar"> <div class="info"> <div class="hd"><span class="username">L</span> </div> <div class="bd">非计算机专业 表示看到这一章已经很懵逼了<br></div> <span class="time">2019-05-08</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">那要加油搞清楚啊。</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/1f/38/38d52458.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">Out</span> </div> <div class="bd">老师您好，在文中您提到：“在这里，如果比较的结果是False，也就是0，就把零标志码设置为1” 这个地方是不是有问题，根据我查到结果，cmp will ZF to 1 when two operands are equal. 所以如果比较的结果是True，才会把零标志码设置为1。<br></div> <span class="time">2019-05-08</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">是得，笔误了。应该是 “如果比较得结果是True，也就是 r == 0，就把零标志码设置为1”<br>不然后面得jne跳转和这里也对不上。</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/9b/ba/333b59e5.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">Linuxer</span> </div> <div class="bd">int main()<br>{<br>   0:   55                      push   rbp<br>   1:   48 89 e5                mov    rbp,rsp<br>   int i = 0;<br>   4:   c7 45 fc 00 00 00 00    mov    DWORD PTR [rbp-0x4],0x0<br>   int a = 0;<br>   b:   c7 45 f8 00 00 00 00    mov    DWORD PTR [rbp-0x8],0x0<br>   switch(i)<br>  12:   8b 45 fc                mov    eax,DWORD PTR [rbp-0x4]<br>  15:   83 f8 01                cmp    eax,0x1<br>  18:   74 07                   je     21 &lt;main+0x21&gt;<br>  1a:   83 f8 02                cmp    eax,0x2<br>  1d:   74 0b                   je     2a &lt;main+0x2a&gt;<br>  1f:   eb 12                   jmp    33 &lt;main+0x33&gt;<br>   {<br>      case 1:<br>        a = 1;<br>  21:   c7 45 f8 01 00 00 00    mov    DWORD PTR [rbp-0x8],0x1<br>        break;<br>  28:   eb 11                   jmp    3b &lt;main+0x3b&gt;<br>      case 2:<br>        a = 2;<br>  2a:   c7 45 f8 02 00 00 00    mov    DWORD PTR [rbp-0x8],0x2<br>        break;<br>  31:   eb 08                   jmp    3b &lt;main+0x3b&gt;<br>      default:<br>        a = 3;<br>  33:   c7 45 f8 03 00 00 00    mov    DWORD PTR [rbp-0x8],0x3<br>        break;<br>  3a:   90                      nop<br>   }<br><br>   return 1;<br>  3b:   b8 01 00 00 00          mov    eax,0x1<br>}<br>  40:   5d                      pop    rbp<br>  41:   c3                      ret<br><br>课后问题验证，这么看如果是单纯的两个分支采用if else更有利，另外 mov    eax,0x1从这儿看象是main的返回值<br></div> <span class="time">2019-05-08</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">是的，如果没有提供返回值，很多版本的编译器会隐式地生成一个return 0;的返回值，就会生成 mov eax, 0x0 的多出来的指令。我修改一下让文章更准确一点。</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/40/d4/9aabdac0.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">aiter</span> </div> <div class="bd">徐老师好～<br>C语言我不会，。，努力看了半天，算是懂了大部分，但是for循环那里还是有点问题～汇编语言里，jmp 1e 之后，应该是做比较cmp，但是为什么不是0和3比较，而是和16进制的2（0x2）比较？<br>————-<br>因为后面用的jle(jump if less or equal) &lt;=2.如果是使用jl(jump if less) &lt;3.应该是编译器的优化行为？可以自己写汇编代码，使用jl 0x3试试效果是否一样<br></div> <span class="time">2019-05-08</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">aiter同学谢谢。我回复了，不过你这里的理解不太对，jle指令并不是和2做比较，而是判断标志位的，jle 和 jl 用的是不同的标志位，具体可以看看这个reference http:&#47;&#47;www.unixwiz.net&#47;techtips&#47;x86-jumps.html</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/ec/3e/51fa2c6e.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">胖胖胖</span> </div> <div class="bd">个人理解：这一讲的核心在于理解几个寄存器的作用，从而理解cpu运行程序的过程：cpu从PC寄存器中取地址，找到地址对应的内存位子，取出其中指令送入指令寄存器执行，然后指令自增，重复操作。所以只要程序在内存中是连续存储的，就会顺序执行这也是冯诺依曼体系的理念吧。而实际上跳转指令就是当前指令修改了当前PC寄存器中所保存的下一条指令的地址，从而实现了跳转。当然各个寄存器实际上是由数电中的一个一个门电路组合出来的，而各个门电路的具体电路形式也是属于模电的东西。对于我们来说，有个具体概念就行，实在需要的时候再回去翻翻课本捡起来就行。<br></div> <span class="time">2019-05-08</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">👍完全正确。</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/f5/b9/888fe350.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">不记年</span> </div> <div class="bd">cpu的在执行指令时还要有个转码的电路来将指令转换成不同的电信号，这些电信号可以控制各个寄存器的动作～<br></div> <span class="time">2019-05-09</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">👍这个关于CPU的控制器的译码器的部分我会在后续讲解CPU的部分讲到。</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/bf/aa/abb7bfe3.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">免费的人</span> </div> <div class="bd">switch case 要看编译器有没有生成跳表，没有的话跟if else效率应该是一样的，比如case个数比较少的情况<br></div> <span class="time">2019-05-09</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">👍</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/37/f9/f5a8d1f9.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">小肚腩era</span> </div> <div class="bd">今年大四，正在实习。在实际工作慢慢发现自己基础知识的薄弱，所以现在也是抓紧时间在补习这些知识。听老师这一讲，又想起了汇编的知识，比起以前，又有了更深的理解。十分期待老师更新专栏~<br></div> <span class="time">2019-05-08</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">👍加油</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/cb/9d/e36c2335.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">　　　　　　　鸟人</span> </div> <div class="bd">大家不要把“汇编语言”当成是像C一样的一门统一编程语言。<br><br>请问这节转换的汇编是哪里的汇编？<br></div> <span class="time">2019-05-08</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">这一节这里用的是Intel X86体系结构的汇编。对应的代码你可以直接复制到Linux下面通过同样的gcc和objdump命令dump出来看。</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">一步</span> </div> <div class="bd">老师，我们常说的二进制执行文件，是指高级语言已经编译成一条条cpu 指令组成的文件吗？<br></div> <span class="time">2019-05-08</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">一步同学你好，差不多，但是不完全一样。二进制可执行文件里面除了指令信息之外还有很多别的信息，可以参考稍后的静态链接那一讲，会更具体地讲解我们的二进制可执行文件里面有些什么内容。</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/9b/ba/333b59e5.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">Linuxer</span> </div> <div class="bd">51:   b8 00 00 00 00          mov    eax,0x0<br>这个会不会是main的返回值呢?<br></div> <span class="time">2019-05-08</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">Linuxer同学你说得对，这个就是main的返回值。</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/16/26/55/e72a671e.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">rookie</span> </div> <div class="bd">程序如下：<br>int main(){<br>	int i = 0;<br>	int a = 0;<br>	switch(i){<br>		case 1:<br>			a = 1;<br>			break;<br>		case 2:<br>			a = 2;<br>			break;<br>		default:<br>			a = 3;<br>			break;}<br>	return 1;<br>}<br><br>下面是机器码和汇编代码：<br>0000000000000000 &lt;main&gt;:<br>   0:	55                            	push   rbp<br>   1:	48 89 e5                   	mov    rbp,rsp<br>   4:	c7 45 f8 00 00 00 00 	mov    DWORD PTR [rbp-0x8],0x0 #将0复制给[rbp-0x8] 这个内存地址，即 i = 0<br>   b:	c7 45 fc 00 00 00 00 	mov    DWORD PTR [rbp-0x4],0x0 #将0复制给[rbp-0x4] 这个内存地址，即 a = 0<br>  12:	8b 45 f8                   	mov    eax,DWORD PTR [rbp-0x8] #将i的值1复制给寄存器eax<br>  15:	83 f8 01                    	cmp    eax,0x1  #将eax与1进行比较，如果true则执行下面的je指令，跳转到21<br>  18:	74 07                        	je     21 &lt;main+0x21&gt;<br>  1a:	83 f8 02                    	cmp    eax,0x2  #将eax与2进行比较，如果true则执行下面的je指令，跳转到2a<br>  1d:	74 0b                       	je     2a &lt;main+0x2a&gt;<br>  1f:	eb 12                        	jmp    33 &lt;main+0x33&gt;                    #跳转到33<br>  21:	c7 45 fc 01 00 00 00   	mov    DWORD PTR [rbp-0x4],0x1     #a = 1<br>  28:	eb 11                         	jmp    3b &lt;main+0x3b&gt;<br>  2a:	c7 45 fc 02 00 00 00 	mov    DWORD PTR [rbp-0x4],0x2     #a = 2<br>  31:	eb 08                       	jmp    3b &lt;main+0x3b&gt;<br>  33:	c7 45 fc 03 00 00 00 	mov    DWORD PTR [rbp-0x4],0x3     #a = 3<br>  3a:	90                            	nop<br>  3b:	b8 01 00 00 00          	mov    eax,0x1                                   # eax = 1<br>  40:	5d                            	pop    rbp<br>  41:	c3                      	        ret                                                     # 返回eax<br></div> <span class="time">2019-05-10</span>  </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/12/ec/2a/b11d5ad8.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">曾经瘦过</span> </div> <div class="bd">对汇编不太理解  具体的代码分析看的有点吃力   基本的流程还是很清晰的 尤其是  卡带的例子 更加形象的 说明了 工作原理 <br></div> <span class="time">2019-05-10</span>  </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/13/13/9d/d91dc762.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">喜欢吃鱼</span> </div> <div class="bd">老师，您上面有个地方是不是笔误了？<br>对于r==0的条件判断，如果比较的结果是False,即r!=0,就把零标志条件码（ZF）设置为1。但是您下面说cmp指令执行完后，开始执行下一条指令jne会检查零标志位，如果为0，则跳转到操作数4a的位置。前面不是在r!=0的时候把ZF置为1了吗？所以这里应该是检查到零标志位1才跳转到4a的位置吧，是我理解错了吗？<br><br></div> <span class="time">2019-05-10</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">是得，笔误了，但是不是后面JNE写反了，而是前面置标志位写反了。<br>应该是 “ 如果比较的结果是 True，也就是 r == 0”，才会置 ZF = 1, JNE还是按照 ZF = 0 才会跳转。</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/56/72/6c5c9a7b.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">二进制</span> </div> <div class="bd">认真学一遍汇编课程，你会觉得这文章很简单。<br></div> <span class="time">2019-05-10</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">👍</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/14/ba/01/c5161563.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">Geek</span> </div> <div class="bd">徐老师好～<br>C语言我不会，。，努力看了半天，算是懂了大部分，但是for循环那里还是有点问题～汇编语言里，jmp 1e 之后，应该是做比较cmp，但是为什么不是0和3比较，而是和16进制的2（0x2）比较？<br></div> <span class="time">2019-05-08</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">因为 i &lt; 3 对于一个整数来说等价于 i &lt;= 2 或者说 i - 2 &gt;= 0。如果我没有记错的话，CMP指令设置FLAG是和 SUB 这个减法指令一致，根据加法后结果的符号来设置FLAG</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/16/88/8b/7c9b68d6.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">豫樟</span> </div> <div class="bd">老师这几节的安排很合理，循序渐进，虽然没学过汇编，但听完之后也能观其大略，拓展知识面，也是清爽的八达鸟!<br></div> <span class="time">2019-05-08</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">👍谢谢支持</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/16/56/c6/0b449bc6.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">Geek_56d656</span> </div> <div class="bd">之前听说java的switch case编译出来的就相当于if else<br></div> <span class="time">2019-05-08</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">并不一样啊，可以自己编译一下看看对应的中间代码。</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/11/9b/ba/333b59e5.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">Linuxer</span> </div> <div class="bd">请问gdb info reg 里面有当前指令寄存器吗？我印象中rip是PC<br></div> <span class="time">2019-05-08</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">有的，就是rip。</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  <li data-v-87ffcada="" class="comment-item"><img src="https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg" class="avatar"> <div class="info"> <div class="hd"><span class="username">一步</span> </div> <div class="bd">编译了一下，switch...case是使用je指令跳转的<br></div> <span class="time">2019-05-08</span> <div class="reply"> <div class="reply-hd"><span>作者回复</span></div> <p class="reply-content">一步同学你好，可以把你编译出来的代码和大家分享一下。</p> <p class="reply-time">2019-05-10</p> </div> </div> </li>  </ul> </div> </div> </div> </div> </div> </body> </html>
